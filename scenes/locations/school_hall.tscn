[gd_scene load_steps=13 format=3 uid="uid://school_hall"]

[ext_resource type="PackedScene" uid="uid://player_scene" path="res://scenes/player/Player.tscn" id="1_player"]
[ext_resource type="Script" path="res://scripts/world/spawn_point.gd" id="2_spawn"]
[ext_resource type="Script" path="res://scripts/interactables/sign.gd" id="3_sign"]
[ext_resource type="Script" path="res://scripts/interactables/door.gd" id="4_door"]
[ext_resource type="Script" path="res://scripts/interactables/container.gd" id="5_container"]
[ext_resource type="Script" path="res://scripts/interactables/hidden_sigil.gd" id="6_sigil"]
[ext_resource type="Texture2D" path="res://assets/environments/school_hall.png" id="7_bg"]

[sub_resource type="RectangleShape2D" id="RectangleShape2D_wall_h"]
size = Vector2(496, 16)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_wall_v"]
size = Vector2(16, 336)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_door"]
size = Vector2(32, 24)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_prop"]
size = Vector2(48, 32)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_lockers"]
size = Vector2(24, 80)

[node name="SchoolHall" type="Node2D"]

[node name="Background" type="Sprite2D" parent="."]
position = Vector2(240, 160)
texture = ExtResource("7_bg")

[node name="SpawnPoints" type="Node2D" parent="."]

[node name="FromTown" type="Marker2D" parent="SpawnPoints"]
position = Vector2(240, 280)
script = ExtResource("2_spawn")
spawn_id = "from_town"

[node name="Default" type="Marker2D" parent="SpawnPoints"]
position = Vector2(240, 160)
script = ExtResource("2_spawn")
spawn_id = "default"

[node name="Player" parent="." instance=ExtResource("1_player")]
position = Vector2(240, 160)

[node name="Walls" type="StaticBody2D" parent="."]

[node name="TopWall" type="CollisionShape2D" parent="Walls"]
position = Vector2(240, -8)
shape = SubResource("RectangleShape2D_wall_h")

[node name="BottomWall" type="CollisionShape2D" parent="Walls"]
position = Vector2(240, 328)
shape = SubResource("RectangleShape2D_wall_h")

[node name="LeftWall" type="CollisionShape2D" parent="Walls"]
position = Vector2(-8, 160)
shape = SubResource("RectangleShape2D_wall_v")

[node name="RightWall" type="CollisionShape2D" parent="Walls"]
position = Vector2(488, 160)
shape = SubResource("RectangleShape2D_wall_v")

[node name="Interactables" type="Node2D" parent="."]

[node name="ExitDoor" type="Area2D" parent="Interactables"]
position = Vector2(240, 300)
collision_layer = 2
collision_mask = 1
script = ExtResource("4_door")
target_scene = "res://scenes/locations/cloverhollow_town.tscn"
spawn_id = "from_school"
is_automatic = true

[node name="DoorCollision" type="CollisionShape2D" parent="Interactables/ExitDoor"]
shape = SubResource("RectangleShape2D_door")

[node name="BulletinBoard" type="Area2D" parent="Interactables"]
position = Vector2(120, 40)
collision_layer = 2
script = ExtResource("3_sign")
sign_text = "NOTICE: Festival volunteers needed! Also, has anyone seen the janitor's blacklight? - Principal"

[node name="BoardCollision" type="CollisionShape2D" parent="Interactables/BulletinBoard"]
shape = SubResource("RectangleShape2D_prop")

[node name="TrophyCase" type="Area2D" parent="Interactables"]
position = Vector2(360, 40)
collision_layer = 2
script = ExtResource("3_sign")
sign_text = "Cloverhollow Spelling Bee Champions 1987-2024. One trophy has a strange symbol scratched into it..."

[node name="TrophyCollision" type="CollisionShape2D" parent="Interactables/TrophyCase"]
shape = SubResource("RectangleShape2D_prop")

[node name="Lockers" type="Area2D" parent="Interactables"]
position = Vector2(40, 160)
collision_layer = 2
script = ExtResource("3_sign")
sign_text = "Rows of lockers. Most are locked, but one has a faint glow coming from inside..."

[node name="LockerCollision" type="CollisionShape2D" parent="Interactables/Lockers"]
shape = SubResource("RectangleShape2D_lockers")

[node name="HiddenSigil" type="Area2D" parent="Interactables"]
position = Vector2(440, 160)
collision_layer = 2
script = ExtResource("6_sigil")
sigil_id = "sigil_school"
hidden_text = "Under the blacklight, strange symbols glow on the wall... They form an eye, watching."
revealed_text = "The Eye of the School. It sees all who pass through these halls."

[node name="SigilCollision" type="CollisionShape2D" parent="Interactables/HiddenSigil"]
shape = SubResource("RectangleShape2D_prop")

[node name="JanitorCloset" type="Area2D" parent="Interactables"]
position = Vector2(60, 280)
collision_layer = 2
script = ExtResource("5_container")
container_id = "school_janitor_closet"
item_id = "blacklight_lantern"
item_count = 1
loot_text = "Found the Blacklight Lantern! It hums softly in your hands..."
opened_text = "An empty closet. Smells like cleaning supplies."

[node name="ClosetCollision" type="CollisionShape2D" parent="Interactables/JanitorCloset"]
shape = SubResource("RectangleShape2D_door")
