[gd_scene load_steps=8 format=3 uid="uid://homeroom_scene"]

[ext_resource type="PackedScene" path="res://scenes/player/Player.tscn" id="1_player"]
[ext_resource type="Script" uid="uid://d1karbxyqsu24" path="res://scripts/world/spawn_point.gd" id="2_spawn"]
[ext_resource type="Script" uid="uid://c3i6iyv6a1sqc" path="res://scripts/interactables/door.gd" id="3_door"]
[ext_resource type="Script" uid="uid://djpct1dcayo4u" path="res://scripts/interactables/sign.gd" id="4_sign"]
[ext_resource type="Script" uid="uid://b066nf0p6ii4o" path="res://scripts/interactables/npc.gd" id="5_npc"]
[ext_resource type="Texture2D" uid="uid://dgerb1bnstak4" path="res://assets/environments/school_homeroom.jpg" id="6_bg"]
[ext_resource type="Texture2D" uid="uid://hy3hre7k0lxr" path="res://assets/sprites/npcs/kid/idle.png" id="7_npc_sprite"]

[sub_resource type="RectangleShape2D" id="RectangleShape2D_exit_door"]
size = Vector2(80, 40)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_npc"]
size = Vector2(48, 48)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_prop"]
size = Vector2(60, 50)

[node name="SchoolHomeroom" type="Node2D"]

[node name="Background" type="Sprite2D" parent="."]
position = Vector2(704, 384)
texture = ExtResource("6_bg")

[node name="SpawnPoints" type="Node2D" parent="."]

[node name="FromHall" type="Marker2D" parent="SpawnPoints"]
position = Vector2(700, 600)
script = ExtResource("2_spawn")
spawn_id = "from_hall"

[node name="Default" type="Marker2D" parent="SpawnPoints"]
position = Vector2(700, 500)
script = ExtResource("2_spawn")
spawn_id = "default"

[node name="Player" parent="." instance=ExtResource("1_player")]
position = Vector2(700, 600)

[node name="Collisions" type="StaticBody2D" parent="."]

[node name="TopWall" type="CollisionPolygon2D" parent="Collisions"]
polygon = PackedVector2Array(0, 0, 1408, 0, 1408, 280, 0, 280)

[node name="BottomWall" type="CollisionPolygon2D" parent="Collisions"]
polygon = PackedVector2Array(0, 680, 1408, 680, 1408, 768, 0, 768)

[node name="LeftWall" type="CollisionPolygon2D" parent="Collisions"]
polygon = PackedVector2Array(0, 0, 80, 0, 80, 768, 0, 768)

[node name="RightWall" type="CollisionPolygon2D" parent="Collisions"]
polygon = PackedVector2Array(1328, 0, 1408, 0, 1408, 768, 1328, 768)

[node name="Interactables" type="Node2D" parent="."]

[node name="ExitDoor" type="Area2D" parent="Interactables"]
position = Vector2(700, 680)
collision_layer = 2
script = ExtResource("3_door")
target_scene = "res://scenes/locations/school_upstairs_hall.tscn"
spawn_id = "from_homeroom"
is_automatic = true

[node name="ExitDoorCollision" type="CollisionShape2D" parent="Interactables/ExitDoor"]
shape = SubResource("RectangleShape2D_exit_door")

[node name="MrsMaple" type="Area2D" parent="Interactables"]
position = Vector2(700, 350)
collision_layer = 2
script = ExtResource("5_npc")
npc_name = "Mrs. Maple"
dialogue_lines = ["Good morning, class! Today we're learning about the history of Cloverhollow.", "Did you know this town was founded over 200 years ago?", "Some say there are secrets hidden all around us... but that's just folklore, of course!"]

[node name="TeacherSprite" type="Sprite2D" parent="Interactables/MrsMaple"]
scale = Vector2(0.15, 0.15)
texture = ExtResource("7_npc_sprite")

[node name="TeacherCollision" type="CollisionShape2D" parent="Interactables/MrsMaple"]
shape = SubResource("RectangleShape2D_npc")

[node name="Chalkboard" type="Area2D" parent="Interactables"]
position = Vector2(700, 300)
collision_layer = 2
script = ExtResource("4_sign")
sign_text = "Today's lesson: 'The Founding of Cloverhollow - Myth or Mystery?'"

[node name="ChalkboardCollision" type="CollisionShape2D" parent="Interactables/Chalkboard"]
shape = SubResource("RectangleShape2D_prop")

[node name="StudentDesk" type="Area2D" parent="Interactables"]
position = Vector2(400, 500)
collision_layer = 2
script = ExtResource("4_sign")
sign_text = "Someone carved a tiny star into this desk. It seems to shimmer faintly..."

[node name="DeskCollision" type="CollisionShape2D" parent="Interactables/StudentDesk"]
shape = SubResource("RectangleShape2D_prop")
