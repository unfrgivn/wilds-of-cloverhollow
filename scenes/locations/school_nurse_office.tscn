[gd_scene load_steps=11 format=3 uid="uid://7a3k5oesd8fp"]

[ext_resource type="PackedScene" path="res://scenes/player/Player.tscn" id="1_player"]
[ext_resource type="Script" uid="uid://d1karbxyqsu24" path="res://scripts/world/spawn_point.gd" id="2_spawn"]
[ext_resource type="Script" uid="uid://c3i6iyv6a1sqc" path="res://scripts/interactables/door.gd" id="3_door"]
[ext_resource type="Script" uid="uid://djpct1dcayo4u" path="res://scripts/interactables/sign.gd" id="4_sign"]
[ext_resource type="Script" uid="uid://b066nf0p6ii4o" path="res://scripts/interactables/npc.gd" id="5_npc"]
[ext_resource type="Texture2D" uid="uid://crwe82fpqg3un" path="res://assets/environments/school_nurse_office.jpg" id="6_bg"]
[ext_resource type="Texture2D" path="res://assets/sprites/npcs/nurse_hollie/idle.png" id="7_npc_sprite"]

[sub_resource type="RectangleShape2D" id="RectangleShape2D_exit_door"]
size = Vector2(80, 40)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_npc"]
size = Vector2(48, 48)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_prop"]
size = Vector2(60, 50)

[node name="SchoolNurseOffice" type="Node2D"]

[node name="Background" type="Sprite2D" parent="."]
position = Vector2(704, 384)
texture = ExtResource("6_bg")

[node name="SpawnPoints" type="Node2D" parent="."]

[node name="FromHall" type="Marker2D" parent="SpawnPoints"]
position = Vector2(700, 600)
script = ExtResource("2_spawn")
spawn_id = "from_hall"

[node name="FromStairwell" type="Marker2D" parent="SpawnPoints"]
position = Vector2(900, 500)
script = ExtResource("2_spawn")
spawn_id = "from_stairwell"

[node name="Default" type="Marker2D" parent="SpawnPoints"]
position = Vector2(700, 500)
script = ExtResource("2_spawn")
spawn_id = "default"

[node name="Player" parent="." instance=ExtResource("1_player")]
position = Vector2(700, 600)

[node name="Collisions" type="StaticBody2D" parent="."]

[node name="TopWall" type="CollisionPolygon2D" parent="Collisions"]
polygon = PackedVector2Array(290, 70, 1127, 267, 1059, 439, 964, 410, 945, 487, 886, 521, 758, 446, 781, 367, 668, 299, 667, 366, 569, 325, 563, 285, 284, 387)

[node name="BottomWall" type="CollisionPolygon2D" parent="Collisions"]
polygon = PackedVector2Array(283, 515, 703, 731, 811, 683, 1107, 524, 1152, 596, 811, 788, 601, 788, 190, 599)

[node name="LeftWall" type="CollisionPolygon2D" parent="Collisions"]
position = Vector2(209, -93)
polygon = PackedVector2Array(0, 0, 80, 0, 80, 768, 0, 768)

[node name="RightWall" type="CollisionPolygon2D" parent="Collisions"]
position = Vector2(-262, -101)
polygon = PackedVector2Array(1328, 0, 1408, 0, 1408, 768, 1328, 768)

[node name="Chair" type="CollisionPolygon2D" parent="Collisions"]
position = Vector2(433, -151)
polygon = PackedVector2Array(13, 668, 100, 675, 212, 730, 201, 774, 128, 813, 12, 750)

[node name="Interactables" type="Node2D" parent="."]

[node name="ExitDoor" type="Area2D" parent="Interactables"]
position = Vector2(756, 678)
collision_layer = 2
script = ExtResource("3_door")
target_scene = "res://scenes/locations/school_stairwell.tscn"
spawn_id = "from_nurse"
is_automatic = true

[node name="ExitDoorCollision" type="CollisionShape2D" parent="Interactables/ExitDoor"]
shape = SubResource("RectangleShape2D_exit_door")

[node name="NurseHollie" type="Area2D" parent="Interactables"]
position = Vector2(555, 397)
collision_layer = 2
script = ExtResource("5_npc")
npc_name = "Nurse Hollie"
dialogue_lines = Array[String](["Oh dear, are you feeling unwell?", "Remember to get plenty of rest and eat your vegetables!", "The strangest thing... some students have been complaining about weird dreams lately."])

[node name="NurseSprite" type="Sprite2D" parent="Interactables/NurseHollie"]
scale = Vector2(0.2, 0.2)
texture = ExtResource("7_npc_sprite")

[node name="NurseCollision" type="CollisionShape2D" parent="Interactables/NurseHollie"]
shape = SubResource("RectangleShape2D_npc")

[node name="MedicineCabinet" type="Area2D" parent="Interactables"]
position = Vector2(1023, 469)
collision_layer = 2
script = ExtResource("4_sign")
sign_text = "A cabinet full of bandages, cold medicine, and... is that a jar of fireflies?"

[node name="CabinetCollision" type="CollisionShape2D" parent="Interactables/MedicineCabinet"]
shape = SubResource("RectangleShape2D_prop")

[node name="CotBed" type="Area2D" parent="Interactables"]
position = Vector2(729, 361)
collision_layer = 2
script = ExtResource("4_sign")
sign_text = "A comfy cot with a crisp white sheet. Smells like lavender."

[node name="CotCollision" type="CollisionShape2D" parent="Interactables/CotBed"]
shape = SubResource("RectangleShape2D_prop")
