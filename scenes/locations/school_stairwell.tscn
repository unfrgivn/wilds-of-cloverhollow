[gd_scene load_steps=10 format=3 uid="uid://cbya3opjq0122"]

[ext_resource type="PackedScene" path="res://scenes/player/Player.tscn" id="1_player"]
[ext_resource type="Script" uid="uid://d1karbxyqsu24" path="res://scripts/world/spawn_point.gd" id="2_spawn"]
[ext_resource type="Script" uid="uid://c3i6iyv6a1sqc" path="res://scripts/interactables/door.gd" id="3_door"]
[ext_resource type="Script" uid="uid://djpct1dcayo4u" path="res://scripts/interactables/sign.gd" id="4_sign"]
[ext_resource type="Texture2D" uid="uid://bh8vasdu3b4j4" path="res://assets/environments/school_stairwell.jpg" id="5_bg"]

[sub_resource type="RectangleShape2D" id="RectangleShape2D_nurse_door"]
size = Vector2(80, 40)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_upstairs_door"]
size = Vector2(80, 40)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_prop"]
size = Vector2(60, 50)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_hall_door"]
size = Vector2(80, 40)

[node name="SchoolStairwell" type="Node2D"]

[node name="Background" type="Sprite2D" parent="."]
position = Vector2(704, 384)
texture = ExtResource("5_bg")

[node name="SpawnPoints" type="Node2D" parent="."]

[node name="FromNurse" type="Marker2D" parent="SpawnPoints"]
position = Vector2(718, 433)
script = ExtResource("2_spawn")
spawn_id = "from_nurse"

[node name="FromSecondFloor" type="Marker2D" parent="SpawnPoints"]
position = Vector2(900, 400)
script = ExtResource("2_spawn")
spawn_id = "from_stairs"

[node name="Default" type="Marker2D" parent="SpawnPoints"]
position = Vector2(600, 500)
script = ExtResource("2_spawn")
spawn_id = "default"

[node name="Player" parent="." instance=ExtResource("1_player")]
position = Vector2(600, 500)

[node name="Collisions" type="StaticBody2D" parent="."]

[node name="TopWall" type="CollisionPolygon2D" parent="Collisions"]
position = Vector2(-57, -66)
polygon = PackedVector2Array(0, 0, 1408, 0, 1408, 250, 1077, 250, 931, 479, 700, 367, 550, 459, 453, 583, 415, 698, 143, 742, 0, 250)

[node name="BottomWall" type="CollisionPolygon2D" parent="Collisions"]
polygon = PackedVector2Array(0, 680, 630, 610, 796, 696, 1008, 566, 997, 450, 1162, 171, 1408, 680, 1408, 768, 0, 768)

[node name="LeftWall" type="CollisionPolygon2D" parent="Collisions"]
polygon = PackedVector2Array(0, 0, 100, 0, 100, 768, 0, 768)

[node name="RightWall" type="CollisionPolygon2D" parent="Collisions"]
polygon = PackedVector2Array(1308, 0, 1408, 0, 1408, 768, 1308, 768)

[node name="Interactables" type="Node2D" parent="."]

[node name="ToNurse" type="Area2D" parent="Interactables"]
position = Vector2(743, 349)
collision_layer = 2
script = ExtResource("3_door")
target_scene = "res://scenes/locations/school_nurse_office.tscn"
spawn_id = "from_stairwell"
is_automatic = true

[node name="NurseDoorCollision" type="CollisionShape2D" parent="Interactables/ToNurse"]
shape = SubResource("RectangleShape2D_nurse_door")

[node name="ToSecondFloor" type="Area2D" parent="Interactables"]
position = Vector2(1046, 295)
collision_layer = 2
script = ExtResource("3_door")
target_scene = "res://scenes/locations/school_upstairs_hall.tscn"
spawn_id = "from_stairs"
is_automatic = true

[node name="SecondFloorDoorCollision" type="CollisionShape2D" parent="Interactables/ToSecondFloor"]
shape = SubResource("RectangleShape2D_upstairs_door")

[node name="NoticeBoard" type="Area2D" parent="Interactables"]
position = Vector2(452, 440)
collision_layer = 2
script = ExtResource("4_sign")
sign_text = "NOTICE: The principal's office is open by appointment only. Please knock before entering."

[node name="NoticeBoardCollision" type="CollisionShape2D" parent="Interactables/NoticeBoard"]
shape = SubResource("RectangleShape2D_prop")

[node name="Window" type="Area2D" parent="Interactables"]
position = Vector2(556, 362)
collision_layer = 2
script = ExtResource("4_sign")
sign_text = "Through the window, you can see the town square below. Something glints on the rooftops..."

[node name="WindowCollision" type="CollisionShape2D" parent="Interactables/Window"]
shape = SubResource("RectangleShape2D_prop")

[node name="ToHall" type="Area2D" parent="Interactables"]
position = Vector2(439, 602)
collision_layer = 2
script = ExtResource("3_door")
target_scene = "res://scenes/locations/school_hall.tscn"
spawn_id = "from_stairs"
is_automatic = true

[node name="HallDoorCollision" type="CollisionShape2D" parent="Interactables/ToHall"]
shape = SubResource("RectangleShape2D_hall_door")
